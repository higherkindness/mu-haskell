<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Mu.GraphQL.Quasi.LostParser</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-2"></span><span>  </span><span class="annot"><span class="hs-comment">-- * The Lost 'Parser'&#8482;&#65039;</span></span><span>
</span><span id="line-3"></span><span>  </span><span class="annot"><a href="Mu.GraphQL.Quasi.LostParser.html#parseTypeSysDefinition"><span class="hs-identifier">parseTypeSysDefinition</span></a></span><span>
</span><span id="line-4"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;|&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Attoparsec.Text</span></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Parser</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">many1</span></span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span>                     </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Language.GraphQL.Draft.Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">nameParser</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runParser</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">schemaDocument</span></span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Language.GraphQL.Draft.Syntax</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">GQL</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Text.Parser.Token</span></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">braces</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">symbol</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">whiteSpace</span></span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="annot"><a href="Mu.GraphQL.Quasi.LostParser.html#schemaDefinition"><span class="hs-identifier hs-type">schemaDefinition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">GQL.SchemaDefinition</span></span><span>
</span><span id="line-14"></span><span id="schemaDefinition"><span class="annot"><span class="annottext">schemaDefinition :: Parser SchemaDefinition
</span><a href="Mu.GraphQL.Quasi.LostParser.html#schemaDefinition"><span class="hs-identifier hs-var hs-var">schemaDefinition</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Parser Text String
forall (m :: * -&gt; *). TokenParsing m =&gt; String -&gt; m String
</span><span class="hs-identifier hs-var">symbol</span></span><span> </span><span class="annot"><span class="hs-string">&quot;schema&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text String
-&gt; Parser SchemaDefinition -&gt; Parser SchemaDefinition
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser SchemaDefinition -&gt; Parser SchemaDefinition
forall (m :: * -&gt; *) a. TokenParsing m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">braces</span></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><span class="annottext">Maybe [Directive]
-&gt; [RootOperationTypeDefinition] -&gt; SchemaDefinition
</span><span class="hs-identifier hs-var">GQL.SchemaDefinition</span></span><span>
</span><span id="line-16"></span><span>      </span><span class="annot"><span class="annottext">(Maybe [Directive]
 -&gt; [RootOperationTypeDefinition] -&gt; SchemaDefinition)
-&gt; Parser Text (Maybe [Directive])
-&gt; Parser Text ([RootOperationTypeDefinition] -&gt; SchemaDefinition)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe [Directive] -&gt; Parser Text (Maybe [Directive])
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe [Directive]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-comment">-- ignore [Directive]</span><span>
</span><span id="line-17"></span><span>      </span><span class="annot"><span class="annottext">Parser Text ([RootOperationTypeDefinition] -&gt; SchemaDefinition)
-&gt; Parser Text [RootOperationTypeDefinition]
-&gt; Parser SchemaDefinition
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text RootOperationTypeDefinition
-&gt; Parser Text [RootOperationTypeDefinition]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">many1</span></span><span> </span><span class="annot"><span class="annottext">Parser Text RootOperationTypeDefinition
</span><a href="Mu.GraphQL.Quasi.LostParser.html#rootOperationParser"><span class="hs-identifier hs-var">rootOperationParser</span></a></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="annot"><a href="Mu.GraphQL.Quasi.LostParser.html#rootOperationParser"><span class="hs-identifier hs-type">rootOperationParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">GQL.RootOperationTypeDefinition</span></span><span>
</span><span id="line-21"></span><span id="rootOperationParser"><span class="annot"><span class="annottext">rootOperationParser :: Parser Text RootOperationTypeDefinition
</span><a href="Mu.GraphQL.Quasi.LostParser.html#rootOperationParser"><span class="hs-identifier hs-var hs-var">rootOperationParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><span class="annottext">OperationType -&gt; NamedType -&gt; RootOperationTypeDefinition
</span><span class="hs-identifier hs-var">GQL.RootOperationTypeDefinition</span></span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><span class="annottext">(OperationType -&gt; NamedType -&gt; RootOperationTypeDefinition)
-&gt; Parser Text OperationType
-&gt; Parser Text (NamedType -&gt; RootOperationTypeDefinition)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser Text OperationType
</span><a href="Mu.GraphQL.Quasi.LostParser.html#operationTypeParser"><span class="hs-identifier hs-var">operationTypeParser</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text OperationType
-&gt; Parser Text String -&gt; Parser Text OperationType
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Parser Text String
forall (m :: * -&gt; *). TokenParsing m =&gt; String -&gt; m String
</span><span class="hs-identifier hs-var">symbol</span></span><span> </span><span class="annot"><span class="hs-string">&quot;:&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><span class="annottext">Parser Text (NamedType -&gt; RootOperationTypeDefinition)
-&gt; Parser Text NamedType -&gt; Parser Text RootOperationTypeDefinition
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; NamedType
</span><span class="hs-identifier hs-var">GQL.NamedType</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; NamedType) -&gt; Parser Text Name -&gt; Parser Text NamedType
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text Name
</span><span class="hs-identifier hs-var">nameParser</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="annot"><a href="Mu.GraphQL.Quasi.LostParser.html#operationTypeParser"><span class="hs-identifier hs-type">operationTypeParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">GQL.OperationType</span></span><span>
</span><span id="line-27"></span><span id="operationTypeParser"><span class="annot"><span class="annottext">operationTypeParser :: Parser Text OperationType
</span><a href="Mu.GraphQL.Quasi.LostParser.html#operationTypeParser"><span class="hs-identifier hs-var hs-var">operationTypeParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-28"></span><span>      </span><span class="annot"><span class="annottext">OperationType
</span><span class="hs-identifier hs-var">GQL.OperationTypeQuery</span></span><span> </span><span class="annot"><span class="annottext">OperationType -&gt; Parser Text String -&gt; Parser Text OperationType
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Parser Text String
forall (m :: * -&gt; *). TokenParsing m =&gt; String -&gt; m String
</span><span class="hs-identifier hs-var">symbol</span></span><span> </span><span class="annot"><span class="hs-string">&quot;query&quot;</span></span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><span class="annottext">Parser Text OperationType
-&gt; Parser Text OperationType -&gt; Parser Text OperationType
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">OperationType
</span><span class="hs-identifier hs-var">GQL.OperationTypeMutation</span></span><span> </span><span class="annot"><span class="annottext">OperationType -&gt; Parser Text String -&gt; Parser Text OperationType
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Parser Text String
forall (m :: * -&gt; *). TokenParsing m =&gt; String -&gt; m String
</span><span class="hs-identifier hs-var">symbol</span></span><span> </span><span class="annot"><span class="hs-string">&quot;mutation&quot;</span></span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><span class="annottext">Parser Text OperationType
-&gt; Parser Text OperationType -&gt; Parser Text OperationType
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">OperationType
</span><span class="hs-identifier hs-var">GQL.OperationTypeSubscription</span></span><span> </span><span class="annot"><span class="annottext">OperationType -&gt; Parser Text String -&gt; Parser Text OperationType
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Parser Text String
forall (m :: * -&gt; *). TokenParsing m =&gt; String -&gt; m String
</span><span class="hs-identifier hs-var">symbol</span></span><span> </span><span class="annot"><span class="hs-string">&quot;subscription&quot;</span></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="annot"><a href="Mu.GraphQL.Quasi.LostParser.html#typeSystemDefinition"><span class="hs-identifier hs-type">typeSystemDefinition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">GQL.TypeSystemDefinition</span></span><span class="hs-special">]</span><span>
</span><span id="line-33"></span><span id="typeSystemDefinition"><span class="annot"><span class="annottext">typeSystemDefinition :: Parser [TypeSystemDefinition]
</span><a href="Mu.GraphQL.Quasi.LostParser.html#typeSystemDefinition"><span class="hs-identifier hs-var hs-var">typeSystemDefinition</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Text ()
forall (m :: * -&gt; *). TokenParsing m =&gt; m ()
</span><span class="hs-identifier hs-var">whiteSpace</span></span><span> </span><span class="annot"><span class="annottext">Parser Text ()
-&gt; Parser [TypeSystemDefinition] -&gt; Parser [TypeSystemDefinition]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[TypeSystemDefinition]] -&gt; [TypeSystemDefinition]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[TypeSystemDefinition]] -&gt; [TypeSystemDefinition])
-&gt; Parser Text [[TypeSystemDefinition]]
-&gt; Parser [TypeSystemDefinition]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser [TypeSystemDefinition]
-&gt; Parser Text [[TypeSystemDefinition]]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">many1</span></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-34"></span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.SchemaDocument</span></span><span> </span><span id="local-6989586621679240937"><span class="annot"><span class="annottext">d :: [TypeDefinition]
</span><a href="#local-6989586621679240937"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeDefinition -&gt; TypeSystemDefinition
</span><span class="hs-identifier hs-var">GQL.TypeSystemDefinitionType</span></span><span> </span><span class="annot"><span class="annottext">(TypeDefinition -&gt; TypeSystemDefinition)
-&gt; [TypeDefinition] -&gt; [TypeSystemDefinition]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[TypeDefinition]
</span><a href="#local-6989586621679240937"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SchemaDocument -&gt; [TypeSystemDefinition])
-&gt; Parser Text SchemaDocument -&gt; Parser [TypeSystemDefinition]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text SchemaDocument
</span><span class="hs-identifier hs-var">schemaDocument</span></span><span>
</span><span id="line-35"></span><span>  </span><span class="annot"><span class="annottext">Parser [TypeSystemDefinition]
-&gt; Parser [TypeSystemDefinition] -&gt; Parser [TypeSystemDefinition]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeSystemDefinition
-&gt; [TypeSystemDefinition] -&gt; [TypeSystemDefinition]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TypeSystemDefinition -&gt; [TypeSystemDefinition])
-&gt; (SchemaDefinition -&gt; TypeSystemDefinition)
-&gt; SchemaDefinition
-&gt; [TypeSystemDefinition]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SchemaDefinition -&gt; TypeSystemDefinition
</span><span class="hs-identifier hs-var">GQL.TypeSystemDefinitionSchema</span></span><span> </span><span class="annot"><span class="annottext">(SchemaDefinition -&gt; [TypeSystemDefinition])
-&gt; Parser SchemaDefinition -&gt; Parser [TypeSystemDefinition]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser SchemaDefinition
</span><a href="Mu.GraphQL.Quasi.LostParser.html#schemaDefinition"><span class="hs-identifier hs-var">schemaDefinition</span></a></span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="annot"><a href="Mu.GraphQL.Quasi.LostParser.html#parseTypeSysDefinition"><span class="hs-identifier hs-type">parseTypeSysDefinition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">GQL.TypeSystemDefinition</span></span><span class="hs-special">]</span><span>
</span><span id="line-38"></span><span id="parseTypeSysDefinition"><span class="annot"><span class="annottext">parseTypeSysDefinition :: Text -&gt; Either Text [TypeSystemDefinition]
</span><a href="Mu.GraphQL.Quasi.LostParser.html#parseTypeSysDefinition"><span class="hs-identifier hs-var hs-var">parseTypeSysDefinition</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser [TypeSystemDefinition]
-&gt; Text -&gt; Either Text [TypeSystemDefinition]
forall a. Parser a -&gt; Text -&gt; Either Text a
</span><span class="hs-identifier hs-var">runParser</span></span><span> </span><span class="annot"><span class="annottext">Parser [TypeSystemDefinition]
</span><a href="Mu.GraphQL.Quasi.LostParser.html#typeSystemDefinition"><span class="hs-identifier hs-var">typeSystemDefinition</span></a></span><span>
</span><span id="line-39"></span></pre></body></html>