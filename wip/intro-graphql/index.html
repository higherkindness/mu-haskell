<!DOCTYPE html>
<html>
    <head>
    <meta charset="UTF-8">

    

    <title>Mu-Haskell: Introduction for GraphQL</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Mu is a purely functional library for building microservices.">
    <meta name="keywords" content="functional-programming, monads, monad-transformers, functional-data-structure, swift, bow, fp-types, adt, free-monads, tagless-final, mtl, for-comprehension, category-theory">

    <meta property="og:image" content="/mu-haskell/wip/img/poster.png" />
    <meta property="og:title" content="Mu-Haskell: Introduction for GraphQL" />
    <meta property="og:site_name" content="Mu-Haskell: Introduction for GraphQL" />
    <meta property="og:url" content="https://higherkindess.io/mu-haskell" />
    <meta property="og:type" content="website" />
    <meta property="og:description" content="Mu is a purely functional library for building microservices." />
    <meta property="og:keywords" content="functional-programming, monads, monad-transformers, functional-data-structure, swift, bow, fp-types, adt, free-monads, tagless-final, mtl, for-comprehension, category-theory" />

    <meta name="twitter:text:description" content="Mu is a purely functional library for building microservices." />
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@47deg">
    <meta name="twitter:creator" content="@47deg">
    <meta name="twitter:image" content="/mu-haskell/wip/img/poster.png" />

    <meta property="github-info" data-github-owner="higherkindness" data-github-repo="mu-haskell" />

    <script defer src="/mu-haskell/wip/js/docs.js"></script>

    <!-- Favicon -->
    <link rel="shortcut icon" href="/mu-haskell/wip/img/favicon.png">

    <!-- mu-haskell docs css -->
    <link rel="stylesheet" type="text/css" href="/mu-haskell/wip/css/docs.css">
</head>

    <body>
        <div id="site-sidebar" class="site-sidebar">
  <div class="sidebar-brand">
    <a href="/mu-haskell/wip/" class="brand" title="Mu-Haskell">
      <img
        src="/mu-haskell/wip/img/nav-brand-white.svg"
        alt="Mu-Haskell"
        class="brand-wrapper"
      />
      <span>Mu-Haskell</span>
    </a>
    <button
      id="main-toggle"
      type="button"
      title="Close"
      class="button sidebar-toggle"
    >
      <span class="close"></span>
    </button>
  </div>
  <div class="sidebar-menu">
    
      

      
      
      
      

      
      
      

      

      

    <div class="sidebar-menu-item  ">
      
      <a
        href="/mu-haskell/wip/"
        class=""
        title="Start"
      >
        Start
      </a>
      
    </div>
    

      
      
      
      

      
      
      

      

      

    <div class="sidebar-menu-item  open">
       
      <button
        type="button"
        title="Open Introduction"
        class="button drop-nested"
      >
        Introduction
      </button>
      <div class="caret"></div>
      

      <div class="sub-menu">
        
        
        
        <a
          class=""
          href="/mu-haskell/wip/intro-rpc/"
          title="For RPC"
        >
          For RPC
        </a>
        
        
        
        <a
          class="active"
          href="/mu-haskell/wip/intro-graphql/"
          title="For GraphQL"
        >
          For GraphQL
        </a>
        
      </div>
      
    </div>
    

      
      
      
      

      
      
      

      

      

    <div class="sidebar-menu-item  ">
       
      <a
        href="/mu-haskell/wip/schema/"
        title="Schemas"
        class="drop-nested"
      >
        Schemas
      </a>
      <div class="caret"></div>
      

      <div class="sub-menu">
        
        
        
        <a
          class=""
          href="/mu-haskell/wip/serializers/"
          title="Serialization formats"
        >
          Serialization formats
        </a>
        
        
        
        <a
          class=""
          href="/mu-haskell/wip/registry/"
          title="Registry"
        >
          Registry
        </a>
        
        
        
        <a
          class=""
          href="/mu-haskell/wip/optics/"
          title="Mu-Optics"
        >
          Mu-Optics
        </a>
        
      </div>
      
    </div>
    

      
      
      
      

      
      
      

      

      

    <div class="sidebar-menu-item  ">
       
      <a
        href="/mu-haskell/wip/rpc/"
        title="Services"
        class="drop-nested"
      >
        Services
      </a>
      <div class="caret"></div>
      

      <div class="sub-menu">
        
        
        
        <a
          class=""
          href="/mu-haskell/wip/grpc/server/"
          title="gRPC servers"
        >
          gRPC servers
        </a>
        
        
        
        <a
          class=""
          href="/mu-haskell/wip/grpc/client/"
          title="gRPC clients"
        >
          gRPC clients
        </a>
        
        
        
        <a
          class=""
          href="/mu-haskell/wip/graphql/"
          title="GraphQL"
        >
          GraphQL
        </a>
        
        
        
        <a
          class=""
          href="/mu-haskell/wip/openapi/"
          title="OpenAPI / REST"
        >
          OpenAPI / REST
        </a>
        
      </div>
      
    </div>
    

      
      
      
      

      
      
      

      

      

    <div class="sidebar-menu-item  ">
       
      <button
        type="button"
        title="Open Integrations"
        class="button drop-nested"
      >
        Integrations
      </button>
      <div class="caret"></div>
      

      <div class="sub-menu">
        
        
        
        <a
          class=""
          href="/mu-haskell/wip/db/"
          title="Databases"
        >
          Databases
        </a>
        
        
        
        <a
          class=""
          href="/mu-haskell/wip/transformer/"
          title="Transformers"
        >
          Transformers
        </a>
        
        
        
        <a
          class=""
          href="/mu-haskell/wip/middleware/"
          title="Middleware"
        >
          Middleware
        </a>
        
      </div>
      
    </div>
    

      
      
      
      

      
      
      

      

      

    <div class="sidebar-menu-item  ">
      
      <a
        href="/mu-haskell/wip/talks/"
        class=""
        title="Talks"
      >
        Talks
      </a>
      
    </div>
    
    
  </div>
</div>

        <main id="site-doc" class="site-doc">
    <div class="doc-header">
      <button
        id="menu-toggle"
        type="button"
        class="button doc-toggle"
        title="Toggle">
          <img src="/mu-haskell/wip/img/sidebar-icon-open.svg" alt="Toggle" title="Toggle">
      </button>

      <div class="link-container">
        
        <div id="version-dropdown" class="link-item">

    <button class="button link-like strong" onclick="openDropdown(event)" title="Version">
      
        <i class="nav-item-icon fa fa-lg " aria-hidden="true"></i>
        <span class="nav-item-text">Version</span>
      
    </button>

    <ul class="dropdown dropdown-content">
      
      <li class="dropdown-item">
        <a class="dropdown-item-link" title="Stable" href="https://higherkindness.io/mu-haskell/" target="_blank" rel="noopener noreferrer">
            <span>
              Stable
            </span>
        </a>
      </li>
      
      <li class="dropdown-item">
        <a class="dropdown-item-link" title="Next" href="https://higherkindness.io/mu-haskell/wip" target="_blank" rel="noopener noreferrer">
            <span>
              Next
            </span>
        </a>
      </li>
      
    </ul>

</div>

        
        <div id="api-docs-dropdown" class="link-item">

    <button class="button link-like strong" onclick="openDropdown(event)" title="API Docs">
      
        <i class="nav-item-icon fa fa-lg " aria-hidden="true"></i>
        <span class="nav-item-text">API Docs</span>
      
    </button>

    <ul class="dropdown dropdown-content">
      
      <li class="dropdown-item">
        <a class="dropdown-item-link" title="Stable" href="https://higherkindness.io/mu-haskell/haddock" target="_blank" rel="noopener noreferrer">
            <span>
              Stable
            </span>
        </a>
      </li>
      
      <li class="dropdown-item">
        <a class="dropdown-item-link" title="Next" href="https://higherkindness.io/mu-haskell/wip/haddock" target="_blank" rel="noopener noreferrer">
            <span>
              Next
            </span>
        </a>
      </li>
      
    </ul>

</div>

        
        <div class="link-item">
          <a href="https://github.com/higherkindness/mu-haskell" title="GitHub repo" target="_blank" rel="noopener noreferrer">
            <span class="strong">GitHub</span>
            <span id="stars-count"></span>
          </a>
        </div>
      </div>

    </div>
    <div class="doc-content">
        <h1 id="introduction-to-mu-haskell-for-graphql">Introduction to Mu-Haskell for GraphQL</h1>

<p>This document will help you get started in writing your first GraphQL server using Mu-Haskell and <code class="highlighter-rouge">mu-graphql</code>!</p>

<h2 id="using-the-stack-template">Using the Stack template</h2>

<p>First of all, we‚Äôve prepared a Stack template to boostrap your project easily, just run:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>stack new your-project https://raw.githubusercontent.com/higherkindness/mu-haskell/master/templates/graphql-server.hsfiles <span class="nt">-p</span> <span class="s2">"author-email:haskell.curry@47deg.com"</span> <span class="nt">-p</span> <span class="s2">"author-name:Haskell Curry"</span>
</code></pre></div></div>

<p>After doing this you‚Äôll have a compiling project with all the dependencies in place and a simple <code class="highlighter-rouge">Main.hs</code> file created.</p>

<h2 id="defining-your-graphql-schema">Defining your GraphQL Schema</h2>

<p>The template will generate a <code class="highlighter-rouge">schema.graphql</code> file with a basic ‚Äúhello‚Äù query, feel free to change it with your domain types. For the sake of this intro we‚Äôll use the library example from the <a href="https://www.apollographql.com/docs/apollo-server/schema/schema/">Apollo GraphQL docs</a>:</p>

<div class="language-graphql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">type</span><span class="w"> </span><span class="n">Book</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">title</span><span class="p">:</span><span class="w"> </span><span class="nb">String</span><span class="p">!</span><span class="w">
  </span><span class="n">author</span><span class="p">:</span><span class="w"> </span><span class="n">Author</span><span class="p">!</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="k">type</span><span class="w"> </span><span class="n">Author</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">String</span><span class="p">!</span><span class="w">
  </span><span class="n">books</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="n">Book</span><span class="p">!]!</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="k">type</span><span class="w"> </span><span class="n">Query</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">authors</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="n">Author</span><span class="p">!]!</span><span class="w">
  </span><span class="n">books</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="n">Book</span><span class="p">!]!</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>This schema defines <strong>three types: a book, an author, and a query</strong>. All GraphQL APIs have a query type which defines all the possible queries you can ask. In our case, we have a query asking for all the authors in the library and another one for all the books. üìö The exclamation marks all over the place (<code class="highlighter-rouge">!</code>) in GraphQL mean that the data is required to be returned, removing those would result in a <code class="highlighter-rouge">Maybe type</code> in Haskell! üòâ</p>

<h2 id="implementing-the-graphql-server">Implementing the GraphQL Server</h2>

<p>Now let‚Äôs have a look at the already finished <code class="highlighter-rouge">src/Main.hs</code> and we‚Äôll go bit by bit explaining what is going on:</p>

<div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">graphql</span> <span class="s">"ServiceDefinition"</span> <span class="s">"schema.graphql"</span>

<span class="n">main</span> <span class="o">::</span> <span class="kt">IO</span> <span class="nb">()</span>
<span class="n">main</span> <span class="o">=</span> <span class="kr">do</span>
  <span class="n">putStrLn</span> <span class="s">"starting GraphQL server on port 8080"</span>
  <span class="n">runGraphQLAppQuery</span> <span class="mi">8080</span> <span class="n">server</span> <span class="p">(</span><span class="kt">Proxy</span> <span class="o">@</span><span class="s">"Query"</span><span class="p">)</span>

<span class="kr">type</span> <span class="kt">ServiceMapping</span> <span class="o">=</span> <span class="sc">'[</span><span class="err">
 </span>   <span class="s">"Book"</span>   <span class="sc">':</span><span class="err">-</span><span class="o">&gt;</span> <span class="p">(</span><span class="kt">Text</span><span class="p">,</span> <span class="kt">Text</span><span class="p">)</span>
  <span class="p">,</span> <span class="s">"Author"</span> <span class="sc">':</span><span class="err">-</span><span class="o">&gt;</span> <span class="kt">Text</span>
  <span class="p">]</span>

<span class="n">library</span> <span class="o">::</span> <span class="p">[(</span><span class="kt">Text</span><span class="p">,</span> <span class="p">[</span><span class="kt">Text</span><span class="p">])]</span>
<span class="n">library</span>
  <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="s">"Robert Louis Stevenson"</span><span class="p">,</span> <span class="p">[</span><span class="s">"Treasure Island"</span><span class="p">,</span> <span class="s">"Strange Case of Dr Jekyll and Mr Hyde"</span><span class="p">])</span>
    <span class="p">,</span> <span class="p">(</span><span class="s">"Immanuel Kant"</span><span class="p">,</span> <span class="p">[</span><span class="s">"Critique of Pure Reason"</span><span class="p">])</span>
    <span class="p">,</span> <span class="p">(</span><span class="s">"Michael Ende"</span><span class="p">,</span> <span class="p">[</span><span class="s">"The Neverending Story"</span><span class="p">,</span> <span class="s">"Momo"</span><span class="p">])</span>
    <span class="p">]</span>

<span class="n">server</span> <span class="o">::</span> <span class="n">forall</span> <span class="n">m</span><span class="o">.</span> <span class="kt">MonadServer</span> <span class="n">m</span> <span class="o">=&gt;</span> <span class="kt">ServerT</span> <span class="kt">ServiceMapping</span> <span class="kt">ServiceDefinition</span> <span class="n">m</span> <span class="kr">_</span>
<span class="n">server</span> <span class="o">=</span> <span class="n">resolver</span>
  <span class="p">(</span> <span class="n">object</span> <span class="o">@</span><span class="s">"Book"</span>
    <span class="p">(</span> <span class="n">field</span>  <span class="o">@</span><span class="s">"title"</span>  <span class="n">bookTitle</span>
    <span class="p">,</span> <span class="n">field</span>  <span class="o">@</span><span class="s">"author"</span> <span class="n">bookAuthor</span> <span class="p">)</span>
  <span class="p">,</span> <span class="n">object</span> <span class="o">@</span><span class="s">"Author"</span>
    <span class="p">(</span> <span class="n">field</span>  <span class="o">@</span><span class="s">"name"</span>  <span class="n">authorName</span>
    <span class="p">,</span> <span class="n">field</span>  <span class="o">@</span><span class="s">"books"</span> <span class="n">authorBooks</span> <span class="p">)</span>
  <span class="p">,</span> <span class="n">object</span> <span class="o">@</span><span class="s">"Query"</span>
    <span class="p">(</span> <span class="n">method</span> <span class="o">@</span><span class="s">"authors"</span> <span class="n">allAuthors</span>
    <span class="p">,</span> <span class="n">method</span> <span class="o">@</span><span class="s">"books"</span>   <span class="n">allBooks</span> <span class="p">)</span>
  <span class="p">)</span>
  <span class="kr">where</span>
    <span class="n">bookTitle</span> <span class="o">::</span> <span class="p">(</span><span class="kt">Text</span><span class="p">,</span> <span class="kt">Text</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">m</span> <span class="kt">Text</span>
    <span class="n">bookTitle</span> <span class="p">(</span><span class="kr">_</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span> <span class="o">=</span> <span class="n">pure</span> <span class="n">title</span>
    <span class="n">bookAuthor</span> <span class="o">::</span> <span class="p">(</span><span class="kt">Text</span><span class="p">,</span> <span class="kt">Text</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">m</span> <span class="kt">Text</span>
    <span class="n">bookAuthor</span> <span class="p">(</span><span class="n">auth</span><span class="p">,</span> <span class="kr">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">pure</span> <span class="n">auth</span>

    <span class="n">authorName</span> <span class="o">::</span> <span class="kt">Text</span> <span class="o">-&gt;</span> <span class="n">m</span> <span class="kt">Text</span>
    <span class="n">authorName</span> <span class="o">=</span> <span class="n">pure</span>
    <span class="n">authorBooks</span> <span class="o">::</span> <span class="kt">Text</span> <span class="o">-&gt;</span> <span class="n">m</span> <span class="p">[(</span><span class="kt">Text</span><span class="p">,</span> <span class="kt">Text</span><span class="p">)]</span>
    <span class="n">authorBooks</span> <span class="n">name</span> <span class="o">=</span> <span class="n">pure</span> <span class="o">$</span> <span class="p">(</span><span class="n">name</span><span class="p">,)</span> <span class="o">&lt;$&gt;</span> <span class="n">maybe</span> <span class="kt">[]</span> <span class="n">snd</span> <span class="p">(</span><span class="n">find</span> <span class="p">((</span><span class="o">==</span><span class="n">name</span><span class="p">)</span> <span class="o">.</span> <span class="n">fst</span><span class="p">)</span> <span class="n">library</span><span class="p">)</span>

    <span class="n">allAuthors</span> <span class="o">::</span> <span class="n">m</span> <span class="p">[</span><span class="kt">Text</span><span class="p">]</span>
    <span class="n">allAuthors</span> <span class="o">=</span> <span class="n">pure</span> <span class="o">$</span> <span class="n">fst</span> <span class="o">&lt;$&gt;</span> <span class="n">library</span>
    <span class="n">allBooks</span> <span class="o">::</span> <span class="n">m</span> <span class="p">[(</span><span class="kt">Text</span><span class="p">,</span> <span class="kt">Text</span><span class="p">)]</span>
    <span class="n">allBooks</span> <span class="o">=</span> <span class="n">pure</span> <span class="p">[(</span><span class="n">author</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">author</span><span class="p">,</span> <span class="n">books</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="n">library</span><span class="p">,</span> <span class="n">title</span> <span class="o">&lt;-</span> <span class="n">books</span><span class="p">]</span>
</code></pre></div></div>

<h2 id="schema-generation-explained">Schema generation explained</h2>

<p>Notice this important line:</p>

<div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">graphql</span> <span class="s">"ServiceDefinition"</span> <span class="s">"schema.graphql"</span>
</code></pre></div></div>

<p>This is where your <code class="highlighter-rouge">schema.graphql</code> file gets converted to a type-level expression that represents your Schema in terms of Mu-Haskell. Here, we‚Äôre assigning the new schema the name <code class="highlighter-rouge">ServiceDefinition</code>, which will be later use in the next section below.</p>

<h2 id="server-declaration-explained">Server declaration explained</h2>

<p>As you‚Äôve seen, we declare the GraphQL server the following way:</p>

<div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">server</span> <span class="o">::</span> <span class="n">forall</span> <span class="n">m</span><span class="o">.</span> <span class="kt">MonadServer</span> <span class="n">m</span> <span class="o">=&gt;</span> <span class="kt">ServerT</span> <span class="kt">ServiceMapping</span> <span class="kt">ServiceDefinition</span> <span class="n">m</span> <span class="kr">_</span>
<span class="n">server</span> <span class="o">=</span> <span class="n">resolver</span>
  <span class="p">(</span> <span class="n">object</span> <span class="o">@</span><span class="s">"Book"</span>
    <span class="p">(</span> <span class="n">field</span>  <span class="o">@</span><span class="s">"title"</span>  <span class="n">bookTitle</span>
    <span class="p">,</span> <span class="n">field</span>  <span class="o">@</span><span class="s">"author"</span> <span class="n">bookAuthor</span> <span class="p">)</span>
  <span class="p">,</span> <span class="n">object</span> <span class="o">@</span><span class="s">"Author"</span>
    <span class="p">(</span> <span class="n">field</span>  <span class="o">@</span><span class="s">"name"</span>  <span class="n">authorName</span>
    <span class="p">,</span> <span class="n">field</span>  <span class="o">@</span><span class="s">"books"</span> <span class="n">authorBooks</span> <span class="p">)</span>
  <span class="p">,</span> <span class="n">object</span> <span class="o">@</span><span class="s">"Query"</span>
    <span class="p">(</span> <span class="n">method</span> <span class="o">@</span><span class="s">"authors"</span> <span class="n">allAuthors</span>
    <span class="p">,</span> <span class="n">method</span> <span class="o">@</span><span class="s">"books"</span>   <span class="n">allBooks</span> <span class="p">)</span>
  <span class="p">)</span>
</code></pre></div></div>

<p>Here we use the given name <code class="highlighter-rouge">ServiceMapping</code> for the type-level generated GraphQL Schema that we‚Äôve created for you!</p>

<p>To declare the server, you need provide a resolver for each field, using the <code class="highlighter-rouge">object</code> and <code class="highlighter-rouge">field</code> functions. Use <code class="highlighter-rouge">method</code> for the fields in ‚ÄúQuery‚Äù, since it‚Äôs a special case for us (you can read more about <a href="https://higherkindness.io/mu-haskell/graphql/#implementing-the-server">why here</a>).</p>

<blockquote>
  <p>The ordering here is casual, you can declare each type wherever you like (as long as it is inside of the same tuple, of course) and it will still work! üéâ</p>
</blockquote>

<h2 id="servicemapping-explained"><code class="highlighter-rouge">ServiceMapping</code> explained</h2>

<p>You might have noticed this strange piece of code:</p>

<div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">type</span> <span class="kt">ServiceMapping</span> <span class="o">=</span> <span class="sc">'[</span><span class="err">
 </span>   <span class="s">"Book"</span>   <span class="sc">':</span><span class="err">-</span><span class="o">&gt;</span> <span class="p">(</span><span class="kt">Text</span><span class="p">,</span> <span class="kt">Text</span><span class="p">)</span>
  <span class="p">,</span> <span class="s">"Author"</span> <span class="sc">':</span><span class="err">-</span><span class="o">&gt;</span> <span class="kt">Text</span>
  <span class="p">]</span>
</code></pre></div></div>

<p>This is where we establish the <em>relationship</em> between the types. You may have notice that the GraphQL schema contained <strong>recursive</strong> references for the types, that is OK both for GraphQL and for Haskell, but it would not be the case for <em>other languages!</em></p>

<h2 id="resolvers-explained">Resolvers explained</h2>

<p>Now let‚Äôs get to the meat. Although GraphQL will use the least amount of calls possible to find the result to your query, you need to provide ‚Äúpaths‚Äù or roads to every possible piece of your data. Although the example here is a hardcoded list, it could be anything ranging from a text file to a fully-fledged database! üöÄ</p>

<div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">bookTitle</span> <span class="o">::</span> <span class="p">(</span><span class="kt">Text</span><span class="p">,</span> <span class="kt">Text</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">m</span> <span class="kt">Text</span>
<span class="n">bookTitle</span> <span class="p">(</span><span class="kr">_</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span> <span class="o">=</span> <span class="n">pure</span> <span class="n">title</span>
<span class="n">bookAuthor</span> <span class="o">::</span> <span class="p">(</span><span class="kt">Text</span><span class="p">,</span> <span class="kt">Text</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">m</span> <span class="kt">Text</span>
<span class="n">bookAuthor</span> <span class="p">(</span><span class="n">auth</span><span class="p">,</span> <span class="kr">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">pure</span> <span class="n">auth</span>

<span class="n">authorName</span> <span class="o">::</span> <span class="kt">Text</span> <span class="o">-&gt;</span> <span class="n">m</span> <span class="kt">Text</span>
<span class="n">authorName</span> <span class="o">=</span> <span class="n">pure</span>
<span class="n">authorBooks</span> <span class="o">::</span> <span class="kt">Text</span> <span class="o">-&gt;</span> <span class="n">m</span> <span class="p">[(</span><span class="kt">Text</span><span class="p">,</span> <span class="kt">Text</span><span class="p">)]</span>
<span class="n">authorBooks</span> <span class="n">name</span> <span class="o">=</span> <span class="n">pure</span> <span class="o">$</span> <span class="p">(</span><span class="n">name</span><span class="p">,)</span> <span class="o">&lt;$&gt;</span> <span class="n">maybe</span> <span class="kt">[]</span> <span class="n">snd</span> <span class="p">(</span><span class="n">find</span> <span class="p">((</span><span class="o">==</span><span class="n">name</span><span class="p">)</span> <span class="o">.</span> <span class="n">fst</span><span class="p">)</span> <span class="n">library</span><span class="p">)</span>

<span class="n">allAuthors</span> <span class="o">::</span> <span class="n">m</span> <span class="p">[</span><span class="kt">Text</span><span class="p">]</span>
<span class="n">allAuthors</span> <span class="o">=</span> <span class="n">pure</span> <span class="o">$</span> <span class="n">fst</span> <span class="o">&lt;$&gt;</span> <span class="n">library</span>
<span class="n">allBooks</span> <span class="o">::</span> <span class="n">m</span> <span class="p">[(</span><span class="kt">Text</span><span class="p">,</span> <span class="kt">Text</span><span class="p">)]</span>
<span class="n">allBooks</span> <span class="o">=</span> <span class="n">pure</span> <span class="p">[(</span><span class="n">author</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">author</span><span class="p">,</span> <span class="n">books</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="n">library</span><span class="p">,</span> <span class="n">title</span> <span class="o">&lt;-</span> <span class="n">books</span><span class="p">]</span>
</code></pre></div></div>

<p>What is that <code class="highlighter-rouge">m</code> that appears everywhere? Well, since we are using <code class="highlighter-rouge">ScopedTypeVariables</code>, that <code class="highlighter-rouge">m</code> refers to the above typeclass constrain <code class="highlighter-rouge">MonadServer m</code>. That is also why we need to lift with <code class="highlighter-rouge">pure</code> all of our results into the <code class="highlighter-rouge">MonadServer</code>.</p>

<p>We tend to put all those resolver functions in a <code class="highlighter-rouge">where</code> block, but of course you are free to move them around wherever you want! üòú</p>

<h2 id="where-to-go-from-here">Where to go from here</h2>

<p>Here‚Äôs a <a href="https://github.com/higherkindness/mu-haskell/tree/master/graphql/exe">more complete example</a> of how a finished server looks like.</p>

<p>If you are confused or you‚Äôd like to know more about how this all works, have a look at our <a href="https://higherkindness.io/mu-haskell/graphql/">GraphQL docs</a>, or feel free to <a href="https://github.com/higherkindness/mu-haskell/issues">open an issue</a> in the repo and we‚Äôll be happy to help!</p>

<p>Happy hacking! üî•</p>

    </div>
</main>

    </body>
</html>
