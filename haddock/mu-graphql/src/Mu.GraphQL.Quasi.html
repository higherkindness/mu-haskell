<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# language DataKinds         #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# language OverloadedStrings #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# language TemplateHaskell   #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# language TupleSections     #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# language ViewPatterns      #-}</span><span>
</span><span id="line-6"></span><span class="hs-comment">{-|
Description : Quasi-quoters for GraphQL schemas

Read @.graphql@ files as a 'Mu.Schema.Definition.Schema'
and 'Package' with one 'Service' per object in the schema.
-}</span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Mu.GraphQL.Quasi</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-13"></span><span>  </span><span class="annot"><a href="Mu.GraphQL.Quasi.html#graphql"><span class="hs-identifier">graphql</span></a></span><span>
</span><span id="line-14"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.GraphQL.Quasi.html#graphql%27"><span class="hs-identifier">graphql'</span></a></span><span>
</span><span id="line-15"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">liftIO</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Coerce</span></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">coerce</span></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashMap.Strict</span></span><span>           </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HM</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>                     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">foldl'</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">catMaybes</span></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span>                     </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.IO</span></span><span>                  </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TIO</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.UUID</span></span><span>                     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">UUID</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Language.GraphQL.Draft.Syntax</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">GQL</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH</span></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Mu.GraphQL.Annotations.html"><span class="hs-identifier">Mu.GraphQL.Annotations</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Mu.GraphQL.Quasi.LostParser.html"><span class="hs-identifier">Mu.GraphQL.Quasi.LostParser</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Mu.GraphQL.Quasi.LostParser.html#parseTypeSysDefinition"><span class="hs-identifier">parseTypeSysDefinition</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Mu.Rpc</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Mu.Schema.Definition</span></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-comment">-- | Imports an GraphQL schema definition from a file.</span><span>
</span><span id="line-34"></span><span class="annot"><a href="Mu.GraphQL.Quasi.html#graphql"><span class="hs-identifier hs-type">graphql</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>   </span><span class="hs-comment">-- ^ Name for the 'Package' type, the 'Schema' is derived from it</span><span>
</span><span id="line-35"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-comment">-- ^ Route to the file</span><span>
</span><span id="line-36"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>
</span><span id="line-37"></span><span id="graphql"><span class="annot"><span class="annottext">graphql :: String -&gt; String -&gt; Q [Dec]
</span><a href="Mu.GraphQL.Quasi.html#graphql"><span class="hs-identifier hs-var hs-var">graphql</span></a></span></span><span> </span><span id="local-6989586621679242121"><span class="annot"><span class="annottext">name :: String
</span><a href="#local-6989586621679242121"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String -&gt; Q [Dec]
</span><a href="Mu.GraphQL.Quasi.html#graphql%27"><span class="hs-identifier hs-var">graphql'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679242121"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Schema&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679242121"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-comment">-- | Imports an GraphQL schema definition from a file.</span><span>
</span><span id="line-40"></span><span class="annot"><a href="Mu.GraphQL.Quasi.html#graphql%27"><span class="hs-identifier hs-type">graphql'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>   </span><span class="hs-comment">-- ^ Name for the 'Schema' type</span><span>
</span><span id="line-41"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>   </span><span class="hs-comment">-- ^ Name for the 'Package' type</span><span>
</span><span id="line-42"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-comment">-- ^ Route to the file</span><span>
</span><span id="line-43"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>
</span><span id="line-44"></span><span id="graphql%27"><span class="annot"><span class="annottext">graphql' :: String -&gt; String -&gt; String -&gt; Q [Dec]
</span><a href="Mu.GraphQL.Quasi.html#graphql%27"><span class="hs-identifier hs-var hs-var">graphql'</span></a></span></span><span> </span><span id="local-6989586621679242120"><span class="annot"><span class="annottext">scName :: String
</span><a href="#local-6989586621679242120"><span class="hs-identifier hs-var">scName</span></a></span></span><span> </span><span id="local-6989586621679242119"><span class="annot"><span class="annottext">svName :: String
</span><a href="#local-6989586621679242119"><span class="hs-identifier hs-var">svName</span></a></span></span><span> </span><span id="local-6989586621679242118"><span class="annot"><span class="annottext">file :: String
</span><a href="#local-6989586621679242118"><span class="hs-identifier hs-var">file</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-45"></span><span>  </span><span id="local-6989586621679242117"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679242117"><span class="hs-identifier hs-var">schema</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Text -&gt; Q Text
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO Text -&gt; Q Text) -&gt; IO Text -&gt; Q Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO Text
</span><span class="hs-identifier hs-var">TIO.readFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679242118"><span class="hs-identifier hs-var">file</span></a></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text [TypeSystemDefinition]
</span><a href="Mu.GraphQL.Quasi.LostParser.html#parseTypeSysDefinition"><span class="hs-identifier hs-var">parseTypeSysDefinition</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679242117"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679242115"><span class="annot"><span class="annottext">e :: Text
</span><a href="#local-6989586621679242115"><span class="hs-identifier hs-var">e</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q [Dec]
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;could not parse graphql spec: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679242115"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679242113"><span class="annot"><span class="annottext">p :: [TypeSystemDefinition]
</span><a href="#local-6989586621679242113"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; [TypeSystemDefinition] -&gt; Q [Dec]
</span><a href="Mu.GraphQL.Quasi.html#graphqlToDecls"><span class="hs-identifier hs-var">graphqlToDecls</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679242120"><span class="hs-identifier hs-var">scName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679242119"><span class="hs-identifier hs-var">svName</span></a></span><span> </span><span class="annot"><span class="annottext">[TypeSystemDefinition]
</span><a href="#local-6989586621679242113"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">type</span><span> </span><span id="TypeMap"><span class="annot"><a href="Mu.GraphQL.Quasi.html#TypeMap"><span class="hs-identifier hs-var">TypeMap</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HM.HashMap</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="annot"><a href="Mu.GraphQL.Quasi.html#GQLType"><span class="hs-identifier hs-type">GQLType</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">type</span><span> </span><span id="SchemaMap"><span class="annot"><a href="Mu.GraphQL.Quasi.html#SchemaMap"><span class="hs-identifier hs-var">SchemaMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HM.HashMap</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">GQL.OperationType</span></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-keyword">data</span><span> </span><span id="Result"><span class="annot"><a href="Mu.GraphQL.Quasi.html#Result"><span class="hs-identifier hs-var">Result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-54"></span><span>    </span><span id="GQLScalar"><span class="annot"><a href="Mu.GraphQL.Quasi.html#GQLScalar"><span class="hs-identifier hs-var">GQLScalar</span></a></span></span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="GQLSchema"><span class="annot"><a href="Mu.GraphQL.Quasi.html#GQLSchema"><span class="hs-identifier hs-var">GQLSchema</span></a></span></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="GQLService"><span class="annot"><a href="Mu.GraphQL.Quasi.html#GQLService"><span class="hs-identifier hs-var">GQLService</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-keyword">data</span><span> </span><span id="GQLType"><span class="annot"><a href="Mu.GraphQL.Quasi.html#GQLType"><span class="hs-identifier hs-var">GQLType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-59"></span><span>    </span><span id="Enum"><span class="annot"><a href="Mu.GraphQL.Quasi.html#Enum"><span class="hs-identifier hs-var">Enum</span></a></span></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Object"><span class="annot"><a href="Mu.GraphQL.Quasi.html#Object"><span class="hs-identifier hs-var">Object</span></a></span></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Scalar"><span class="annot"><a href="Mu.GraphQL.Quasi.html#Scalar"><span class="hs-identifier hs-var">Scalar</span></a></span></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="InputObject"><span class="annot"><a href="Mu.GraphQL.Quasi.html#InputObject"><span class="hs-identifier hs-var">InputObject</span></a></span></span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Other"><span class="annot"><a href="Mu.GraphQL.Quasi.html#Other"><span class="hs-identifier hs-var">Other</span></a></span></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="annot"><a href="Mu.GraphQL.Quasi.html#classifySchema"><span class="hs-identifier hs-type">classifySchema</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">GQL.SchemaDefinition</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Mu.GraphQL.Quasi.html#SchemaMap"><span class="hs-identifier hs-type">SchemaMap</span></a></span><span>
</span><span id="line-66"></span><span id="classifySchema"><span class="annot"><span class="annottext">classifySchema :: [SchemaDefinition] -&gt; SchemaMap
</span><a href="Mu.GraphQL.Quasi.html#classifySchema"><span class="hs-identifier hs-var hs-var">classifySchema</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SchemaMap -&gt; SchemaDefinition -&gt; SchemaMap)
-&gt; SchemaMap -&gt; [SchemaDefinition] -&gt; SchemaMap
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">SchemaMap -&gt; SchemaDefinition -&gt; SchemaMap
</span><a href="#local-6989586621679242102"><span class="hs-identifier hs-var">schemaToMap</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaMap
forall k v. HashMap k v
</span><span class="hs-identifier hs-var">HM.empty</span></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><a href="#local-6989586621679242102"><span class="hs-identifier hs-type">schemaToMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Mu.GraphQL.Quasi.html#SchemaMap"><span class="hs-identifier hs-type">SchemaMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GQL.SchemaDefinition</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Mu.GraphQL.Quasi.html#SchemaMap"><span class="hs-identifier hs-type">SchemaMap</span></a></span><span>
</span><span id="line-69"></span><span>    </span><span id="local-6989586621679242102"><span class="annot"><span class="annottext">schemaToMap :: SchemaMap -&gt; SchemaDefinition -&gt; SchemaMap
</span><a href="#local-6989586621679242102"><span class="hs-identifier hs-var hs-var">schemaToMap</span></a></span></span><span> </span><span id="local-6989586621679242100"><span class="annot"><span class="annottext">mp :: SchemaMap
</span><a href="#local-6989586621679242100"><span class="hs-identifier hs-var">mp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.SchemaDefinition</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679242098"><span class="annot"><span class="annottext">ops :: [RootOperationTypeDefinition]
</span><a href="#local-6989586621679242098"><span class="hs-identifier hs-var">ops</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SchemaMap -&gt; RootOperationTypeDefinition -&gt; SchemaMap)
-&gt; SchemaMap -&gt; [RootOperationTypeDefinition] -&gt; SchemaMap
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">SchemaMap -&gt; RootOperationTypeDefinition -&gt; SchemaMap
</span><a href="#local-6989586621679242097"><span class="hs-identifier hs-var">operationToKeyValue</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaMap
</span><a href="#local-6989586621679242100"><span class="hs-identifier hs-var">mp</span></a></span><span> </span><span class="annot"><span class="annottext">[RootOperationTypeDefinition]
</span><a href="#local-6989586621679242098"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><a href="#local-6989586621679242097"><span class="hs-identifier hs-type">operationToKeyValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Mu.GraphQL.Quasi.html#SchemaMap"><span class="hs-identifier hs-type">SchemaMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GQL.RootOperationTypeDefinition</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Mu.GraphQL.Quasi.html#SchemaMap"><span class="hs-identifier hs-type">SchemaMap</span></a></span><span>
</span><span id="line-71"></span><span>    </span><span id="local-6989586621679242097"><span class="annot"><span class="annottext">operationToKeyValue :: SchemaMap -&gt; RootOperationTypeDefinition -&gt; SchemaMap
</span><a href="#local-6989586621679242097"><span class="hs-identifier hs-var hs-var">operationToKeyValue</span></a></span></span><span> </span><span id="local-6989586621679242096"><span class="annot"><span class="annottext">mp :: SchemaMap
</span><a href="#local-6989586621679242096"><span class="hs-identifier hs-var">mp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.RootOperationTypeDefinition</span></span><span> </span><span id="local-6989586621679242094"><span class="annot"><span class="annottext">opType :: OperationType
</span><a href="#local-6989586621679242094"><span class="hs-identifier hs-var">opType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamedType -&gt; Text
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679242093"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679242093"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; OperationType -&gt; SchemaMap -&gt; SchemaMap
forall k v.
(Eq k, Hashable k) =&gt;
k -&gt; v -&gt; HashMap k v -&gt; HashMap k v
</span><span class="hs-identifier hs-var">HM.insert</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679242093"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">OperationType
</span><a href="#local-6989586621679242094"><span class="hs-identifier hs-var">opType</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaMap
</span><a href="#local-6989586621679242096"><span class="hs-identifier hs-var">mp</span></a></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="annot"><a href="Mu.GraphQL.Quasi.html#classify"><span class="hs-identifier hs-type">classify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">GQL.TypeDefinition</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Mu.GraphQL.Quasi.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a></span><span>
</span><span id="line-74"></span><span id="classify"><span class="annot"><span class="annottext">classify :: [TypeDefinition] -&gt; TypeMap
</span><a href="Mu.GraphQL.Quasi.html#classify"><span class="hs-identifier hs-var hs-var">classify</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Text, GQLType)] -&gt; TypeMap
forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; HashMap k v
</span><span class="hs-identifier hs-var">HM.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Text, GQLType)] -&gt; TypeMap)
-&gt; ([TypeDefinition] -&gt; [(Text, GQLType)])
-&gt; [TypeDefinition]
-&gt; TypeMap
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeDefinition -&gt; (Text, GQLType)
</span><a href="#local-6989586621679242088"><span class="hs-identifier hs-var">typeToKeyValue</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeDefinition -&gt; (Text, GQLType))
-&gt; [TypeDefinition] -&gt; [(Text, GQLType)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><a href="#local-6989586621679242088"><span class="hs-identifier hs-type">typeToKeyValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GQL.TypeDefinition</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.GraphQL.Quasi.html#GQLType"><span class="hs-identifier hs-type">GQLType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>    </span><span id="local-6989586621679242088"><span class="annot"><span class="annottext">typeToKeyValue :: TypeDefinition -&gt; (Text, GQLType)
</span><a href="#local-6989586621679242088"><span class="hs-identifier hs-var hs-var">typeToKeyValue</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.TypeDefinitionScalar</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.ScalarTypeDefinition</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679242084"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679242084"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679242084"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GQLType
</span><a href="Mu.GraphQL.Quasi.html#Scalar"><span class="hs-identifier hs-var">Scalar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>    </span><span class="annot"><a href="#local-6989586621679242088"><span class="hs-identifier hs-var">typeToKeyValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.TypeDefinitionObject</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.ObjectTypeDefinition</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679242081"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679242081"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679242081"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GQLType
</span><a href="Mu.GraphQL.Quasi.html#Object"><span class="hs-identifier hs-var">Object</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><a href="#local-6989586621679242088"><span class="hs-identifier hs-var">typeToKeyValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.TypeDefinitionInterface</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.InterfaceTypeDefinition</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679242078"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679242078"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679242078"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GQLType
</span><a href="Mu.GraphQL.Quasi.html#Other"><span class="hs-identifier hs-var">Other</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>    </span><span class="annot"><a href="#local-6989586621679242088"><span class="hs-identifier hs-var">typeToKeyValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.TypeDefinitionUnion</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.UnionTypeDefinition</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679242075"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679242075"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679242075"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GQLType
</span><a href="Mu.GraphQL.Quasi.html#Other"><span class="hs-identifier hs-var">Other</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>    </span><span class="annot"><a href="#local-6989586621679242088"><span class="hs-identifier hs-var">typeToKeyValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.TypeDefinitionEnum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.EnumTypeDefinition</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679242072"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679242072"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679242072"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GQLType
</span><a href="Mu.GraphQL.Quasi.html#Enum"><span class="hs-identifier hs-var">Enum</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><a href="#local-6989586621679242088"><span class="hs-identifier hs-var">typeToKeyValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.TypeDefinitionInputObject</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.InputObjectTypeDefinition</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679242069"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679242069"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679242069"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GQLType
</span><a href="Mu.GraphQL.Quasi.html#InputObject"><span class="hs-identifier hs-var">InputObject</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-comment">-- | Constructs the GraphQL tree splitting between Schemas and Services.</span><span>
</span><span id="line-91"></span><span class="annot"><a href="Mu.GraphQL.Quasi.html#graphqlToDecls"><span class="hs-identifier hs-type">graphqlToDecls</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">GQL.TypeSystemDefinition</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>
</span><span id="line-92"></span><span id="graphqlToDecls"><span class="annot"><span class="annottext">graphqlToDecls :: String -&gt; String -&gt; [TypeSystemDefinition] -&gt; Q [Dec]
</span><a href="Mu.GraphQL.Quasi.html#graphqlToDecls"><span class="hs-identifier hs-var hs-var">graphqlToDecls</span></a></span></span><span> </span><span id="local-6989586621679242068"><span class="annot"><span class="annottext">schemaName :: String
</span><a href="#local-6989586621679242068"><span class="hs-identifier hs-var">schemaName</span></a></span></span><span> </span><span id="local-6989586621679242067"><span class="annot"><span class="annottext">serviceName :: String
</span><a href="#local-6989586621679242067"><span class="hs-identifier hs-var">serviceName</span></a></span></span><span> </span><span id="local-6989586621679242066"><span class="annot"><span class="annottext">allTypes :: [TypeSystemDefinition]
</span><a href="#local-6989586621679242066"><span class="hs-identifier hs-var">allTypes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679242065"><span class="annot"><span class="annottext">schemaName' :: Name
</span><a href="#local-6989586621679242065"><span class="hs-identifier hs-var hs-var">schemaName'</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name
</span><span class="hs-identifier hs-var">mkName</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679242068"><span class="hs-identifier hs-var">schemaName</span></a></span><span>
</span><span id="line-94"></span><span>      </span><span id="local-6989586621679242064"><span class="annot"><span class="annottext">serviceName' :: Name
</span><a href="#local-6989586621679242064"><span class="hs-identifier hs-var hs-var">serviceName'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name
</span><span class="hs-identifier hs-var">mkName</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679242067"><span class="hs-identifier hs-var">serviceName</span></a></span><span>
</span><span id="line-95"></span><span>      </span><span id="local-6989586621679242063"><span class="annot"><span class="annottext">types :: [TypeDefinition]
</span><a href="#local-6989586621679242063"><span class="hs-identifier hs-var hs-var">types</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TypeDefinition
</span><a href="#local-6989586621679242062"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GQL.TypeSystemDefinitionType</span></span><span> </span><span id="local-6989586621679242062"><span class="annot"><span class="annottext">t :: TypeDefinition
</span><a href="#local-6989586621679242062"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TypeSystemDefinition]
</span><a href="#local-6989586621679242066"><span class="hs-identifier hs-var">allTypes</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-96"></span><span>      </span><span id="local-6989586621679242060"><span class="annot"><span class="annottext">schTypes :: [SchemaDefinition]
</span><a href="#local-6989586621679242060"><span class="hs-identifier hs-var hs-var">schTypes</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SchemaDefinition
</span><a href="#local-6989586621679242059"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GQL.TypeSystemDefinitionSchema</span></span><span> </span><span id="local-6989586621679242059"><span class="annot"><span class="annottext">t :: SchemaDefinition
</span><a href="#local-6989586621679242059"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TypeSystemDefinition]
</span><a href="#local-6989586621679242066"><span class="hs-identifier hs-var">allTypes</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-97"></span><span>      </span><span id="local-6989586621679242057"><span class="annot"><span class="annottext">typeMap :: TypeMap
</span><a href="#local-6989586621679242057"><span class="hs-identifier hs-var hs-var">typeMap</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TypeDefinition] -&gt; TypeMap
</span><a href="Mu.GraphQL.Quasi.html#classify"><span class="hs-identifier hs-var">classify</span></a></span><span> </span><span class="annot"><span class="annottext">[TypeDefinition]
</span><a href="#local-6989586621679242063"><span class="hs-identifier hs-var">types</span></a></span><span>
</span><span id="line-98"></span><span>      </span><span id="local-6989586621679242056"><span class="annot"><span class="annottext">schMap :: SchemaMap
</span><a href="#local-6989586621679242056"><span class="hs-identifier hs-var hs-var">schMap</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SchemaDefinition] -&gt; SchemaMap
</span><a href="Mu.GraphQL.Quasi.html#classifySchema"><span class="hs-identifier hs-var">classifySchema</span></a></span><span> </span><span class="annot"><span class="annottext">[SchemaDefinition]
</span><a href="#local-6989586621679242060"><span class="hs-identifier hs-var">schTypes</span></a></span><span>
</span><span id="line-99"></span><span>  </span><span id="local-6989586621679242055"><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621679242055"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TypeDefinition -&gt; Q Result) -&gt; [TypeDefinition] -&gt; Q [Result]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; TypeMap -&gt; SchemaMap -&gt; TypeDefinition -&gt; Q Result
</span><a href="Mu.GraphQL.Quasi.html#typeToDec"><span class="hs-identifier hs-var">typeToDec</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679242065"><span class="hs-identifier hs-var">schemaName'</span></a></span><span> </span><span class="annot"><span class="annottext">TypeMap
</span><a href="#local-6989586621679242057"><span class="hs-identifier hs-var">typeMap</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaMap
</span><a href="#local-6989586621679242056"><span class="hs-identifier hs-var">schMap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TypeDefinition]
</span><a href="#local-6989586621679242063"><span class="hs-identifier hs-var">types</span></a></span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679242052"><span class="annot"><span class="annottext">schemaTypes :: [Type]
</span><a href="#local-6989586621679242052"><span class="hs-identifier hs-var hs-var">schemaTypes</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679242051"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Mu.GraphQL.Quasi.html#GQLSchema"><span class="hs-identifier hs-type">GQLSchema</span></a></span><span>  </span><span id="local-6989586621679242051"><span class="annot"><span class="annottext">x :: Type
</span><a href="#local-6989586621679242051"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621679242055"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-101"></span><span>      </span><span id="local-6989586621679242050"><span class="annot"><span class="annottext">serviceTypes :: [Type]
</span><a href="#local-6989586621679242050"><span class="hs-identifier hs-var hs-var">serviceTypes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679242049"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Mu.GraphQL.Quasi.html#GQLService"><span class="hs-identifier hs-type">GQLService</span></a></span><span> </span><span id="local-6989586621679242049"><span class="annot"><span class="annottext">x :: Type
</span><a href="#local-6989586621679242049"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621679242055"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-102"></span><span>      </span><span id="local-6989586621679242048"><span class="annot"><span class="annottext">defaultDefs :: [(Text, (Text, (Text, Type)))]
</span><a href="#local-6989586621679242048"><span class="hs-identifier hs-var hs-var">defaultDefs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[(Text, (Text, (Text, Type)))]] -&gt; [(Text, (Text, (Text, Type)))]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[(Text, (Text, (Text, Type)))]
</span><a href="#local-6989586621679242046"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Mu.GraphQL.Quasi.html#GQLService"><span class="hs-identifier hs-type">GQLService</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679242046"><span class="annot"><span class="annottext">d :: [(Text, (Text, (Text, Type)))]
</span><a href="#local-6989586621679242046"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621679242055"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-103"></span><span>  </span><span id="local-6989586621679242045"><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679242045"><span class="hs-identifier hs-var">schemaDec</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [TyVarBndr] -&gt; TypeQ -&gt; DecQ
</span><span class="hs-identifier hs-var">tySynD</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679242065"><span class="hs-identifier hs-var">schemaName'</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; TypeQ
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; TypeQ) -&gt; Type -&gt; TypeQ
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Type
</span><a href="Mu.GraphQL.Quasi.html#typesToList"><span class="hs-identifier hs-var">typesToList</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679242052"><span class="hs-identifier hs-var">schemaTypes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>  </span><span id="local-6989586621679242042"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679242042"><span class="hs-identifier hs-var">pkgTy</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Package</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">textToStrLit</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">T.pack</span><span> </span><span class="hs-identifier">serviceName</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>                        </span><span class="hs-special">$(</span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">typesToList</span><span> </span><span class="hs-identifier">serviceTypes</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-106"></span><span>  </span><span id="local-6989586621679242041"><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679242041"><span class="hs-identifier hs-var">serviceDec</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [TyVarBndr] -&gt; TypeQ -&gt; DecQ
</span><span class="hs-identifier hs-var">tySynD</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679242064"><span class="hs-identifier hs-var">serviceName'</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; TypeQ
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679242042"><span class="hs-identifier hs-var">pkgTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>  </span><span id="local-6989586621679242040"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679242040"><span class="hs-identifier hs-var">defaultDec</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[d|</span><span> </span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">AnnotatedPackage</span><span> </span><span class="hs-identifier">DefaultValue</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">pure</span><span> </span><span class="hs-identifier">pkgTy</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-108"></span><span>                      </span><span class="hs-special">$(</span><span class="hs-identifier">typesToList</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-identifier">defaultDeclToTy</span><span> </span><span class="hs-identifier">defaultDefs</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><span class="annottext">[Dec] -&gt; Q [Dec]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">([Dec] -&gt; Q [Dec]) -&gt; [Dec] -&gt; Q [Dec]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679242045"><span class="hs-identifier hs-var">schemaDec</span></a></span><span> </span><span class="annot"><span class="annottext">Dec -&gt; [Dec] -&gt; [Dec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679242041"><span class="hs-identifier hs-var">serviceDec</span></a></span><span> </span><span class="annot"><span class="annottext">Dec -&gt; [Dec] -&gt; [Dec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679242040"><span class="hs-identifier hs-var">defaultDec</span></a></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="annot"><a href="Mu.GraphQL.Quasi.html#defaultDeclToTy"><span class="hs-identifier hs-type">defaultDeclToTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-112"></span><span id="defaultDeclToTy"><span class="annot"><span class="annottext">defaultDeclToTy :: (Text, (Text, (Text, Type))) -&gt; TypeQ
</span><a href="Mu.GraphQL.Quasi.html#defaultDeclToTy"><span class="hs-identifier hs-var hs-var">defaultDeclToTy</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679242038"><span class="annot"><span class="annottext">sn :: Text
</span><a href="#local-6989586621679242038"><span class="hs-identifier hs-var">sn</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679242037"><span class="annot"><span class="annottext">mn :: Text
</span><a href="#local-6989586621679242037"><span class="hs-identifier hs-var">mn</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679242036"><span class="annot"><span class="annottext">an :: Text
</span><a href="#local-6989586621679242036"><span class="hs-identifier hs-var">an</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679242035"><span class="annot"><span class="annottext">dv :: Type
</span><a href="#local-6989586621679242035"><span class="hs-identifier hs-var">dv</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">AnnArg</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">textToStrLit</span><span> </span><span class="hs-identifier">sn</span><span class="hs-special">)</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">textToStrLit</span><span> </span><span class="hs-identifier">mn</span><span class="hs-special">)</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">textToStrLit</span><span> </span><span class="hs-identifier">an</span><span class="hs-special">)</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">pure</span><span> </span><span class="hs-identifier">dv</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-comment">-- | Reads a GraphQL 'TypeDefinition' and returns a 'Result'.</span><span>
</span><span id="line-116"></span><span class="annot"><a href="Mu.GraphQL.Quasi.html#typeToDec"><span class="hs-identifier hs-type">typeToDec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Mu.GraphQL.Quasi.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Mu.GraphQL.Quasi.html#SchemaMap"><span class="hs-identifier hs-type">SchemaMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GQL.TypeDefinition</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><a href="Mu.GraphQL.Quasi.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span>
</span><span id="line-117"></span><span id="typeToDec"><span class="annot"><span class="annottext">typeToDec :: Name -&gt; TypeMap -&gt; SchemaMap -&gt; TypeDefinition -&gt; Q Result
</span><a href="Mu.GraphQL.Quasi.html#typeToDec"><span class="hs-identifier hs-var hs-var">typeToDec</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.TypeDefinitionInterface</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Result
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="hs-string">&quot;interface types are not supported&quot;</span></span><span>
</span><span id="line-119"></span><span class="annot"><a href="Mu.GraphQL.Quasi.html#typeToDec"><span class="hs-identifier hs-var">typeToDec</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.TypeDefinitionUnion</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Result
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="hs-string">&quot;union types are not supported&quot;</span></span><span>
</span><span id="line-121"></span><span class="annot"><a href="Mu.GraphQL.Quasi.html#typeToDec"><span class="hs-identifier hs-var">typeToDec</span></a></span><span> </span><span id="local-6989586621679242034"><span class="annot"><span class="annottext">schemaName :: Name
</span><a href="#local-6989586621679242034"><span class="hs-identifier hs-var">schemaName</span></a></span></span><span> </span><span id="local-6989586621679242033"><span class="annot"><span class="annottext">tm :: TypeMap
</span><a href="#local-6989586621679242033"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.TypeDefinitionScalar</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.ScalarTypeDefinition</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679242032"><span class="annot"><span class="annottext">s :: Name
</span><a href="#local-6989586621679242032"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-122"></span><span>  </span><span class="annot"><span class="annottext">Result
</span><a href="Mu.GraphQL.Quasi.html#GQLScalar"><span class="hs-identifier hs-var">GQLScalar</span></a></span><span> </span><span class="annot"><span class="annottext">Result -&gt; TypeQ -&gt; Q Result
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; TypeMap -&gt; Name -&gt; TypeQ
</span><a href="Mu.GraphQL.Quasi.html#gqlTypeToType"><span class="hs-identifier hs-var">gqlTypeToType</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679242032"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">TypeMap
</span><a href="#local-6989586621679242033"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679242034"><span class="hs-identifier hs-var">schemaName</span></a></span><span>
</span><span id="line-123"></span><span class="annot"><a href="Mu.GraphQL.Quasi.html#typeToDec"><span class="hs-identifier hs-var">typeToDec</span></a></span><span> </span><span id="local-6989586621679242029"><span class="annot"><span class="annottext">schemaName :: Name
</span><a href="#local-6989586621679242029"><span class="hs-identifier hs-var">schemaName</span></a></span></span><span> </span><span id="local-6989586621679242028"><span class="annot"><span class="annottext">tm :: TypeMap
</span><a href="#local-6989586621679242028"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span id="local-6989586621679242027"><span class="annot"><span class="annottext">sm :: SchemaMap
</span><a href="#local-6989586621679242027"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.TypeDefinitionObject</span></span><span> </span><span id="local-6989586621679242026"><span class="annot"><span class="annottext">objs :: ObjectTypeDefinition
</span><a href="#local-6989586621679242026"><span class="hs-identifier hs-var">objs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ObjectTypeDefinition -&gt; Q Result
</span><a href="#local-6989586621679242025"><span class="hs-identifier hs-var">objToDec</span></a></span><span> </span><span class="annot"><span class="annottext">ObjectTypeDefinition
</span><a href="#local-6989586621679242026"><span class="hs-identifier hs-var">objs</span></a></span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-125"></span><span>    </span><span class="annot"><a href="#local-6989586621679242025"><span class="hs-identifier hs-type">objToDec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GQL.ObjectTypeDefinition</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><a href="Mu.GraphQL.Quasi.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span>
</span><span id="line-126"></span><span>    </span><span id="local-6989586621679242025"><span class="annot"><span class="annottext">objToDec :: ObjectTypeDefinition -&gt; Q Result
</span><a href="#local-6989586621679242025"><span class="hs-identifier hs-var hs-var">objToDec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.ObjectTypeDefinition</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679242024"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679242024"><span class="hs-identifier hs-var">nm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679242023"><span class="annot"><span class="annottext">flds :: [FieldDefinition]
</span><a href="#local-6989586621679242023"><span class="hs-identifier hs-var">flds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-127"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679242022"><span class="annot"><span class="annottext">fieldInfos :: [Type]
</span><a href="#local-6989586621679242022"><span class="hs-identifier hs-var">fieldInfos</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679242021"><span class="annot"><span class="annottext">defaults :: [[(Text, (Text, Type))]]
</span><a href="#local-6989586621679242021"><span class="hs-identifier hs-var">defaults</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Type, [(Text, (Text, Type))])]
-&gt; ([Type], [[(Text, (Text, Type))]])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="annot"><span class="annottext">([(Type, [(Text, (Text, Type))])]
 -&gt; ([Type], [[(Text, (Text, Type))]]))
-&gt; Q [(Type, [(Text, (Text, Type))])]
-&gt; Q ([Type], [[(Text, (Text, Type))]])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(FieldDefinition -&gt; Q (Type, [(Text, (Text, Type))]))
-&gt; [FieldDefinition] -&gt; Q [(Type, [(Text, (Text, Type))])]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; FieldDefinition -&gt; Q (Type, [(Text, (Text, Type))])
</span><a href="#local-6989586621679242019"><span class="hs-identifier hs-var">gqlFieldToType</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679242024"><span class="hs-identifier hs-var">nm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FieldDefinition]
</span><a href="#local-6989586621679242023"><span class="hs-identifier hs-var">flds</span></a></span><span>
</span><span id="line-128"></span><span>      </span><span class="annot"><span class="annottext">Type -&gt; [(Text, (Text, (Text, Type)))] -&gt; Result
</span><a href="Mu.GraphQL.Quasi.html#GQLService"><span class="hs-identifier hs-var">GQLService</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; [(Text, (Text, (Text, Type)))] -&gt; Result)
-&gt; TypeQ -&gt; Q ([(Text, (Text, (Text, Type)))] -&gt; Result)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Service</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">textToStrLit</span><span> </span><span class="hs-identifier">nm</span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>                                  </span><span class="hs-special">$(</span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">typesToList</span><span> </span><span class="hs-identifier">fieldInfos</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-130"></span><span>                 </span><span class="annot"><span class="annottext">Q ([(Text, (Text, (Text, Type)))] -&gt; Result)
-&gt; Q [(Text, (Text, (Text, Type)))] -&gt; Q Result
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Text, (Text, (Text, Type)))] -&gt; Q [(Text, (Text, (Text, Type)))]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679242024"><span class="hs-identifier hs-var">nm</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Text, (Text, Type)) -&gt; (Text, (Text, (Text, Type))))
-&gt; [(Text, (Text, Type))] -&gt; [(Text, (Text, (Text, Type)))]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[[(Text, (Text, Type))]] -&gt; [(Text, (Text, Type))]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[(Text, (Text, Type))]]
</span><a href="#local-6989586621679242021"><span class="hs-identifier hs-var">defaults</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>    </span><span class="annot"><a href="#local-6989586621679242019"><span class="hs-identifier hs-type">gqlFieldToType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GQL.FieldDefinition</span></span><span>
</span><span id="line-132"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>    </span><span id="local-6989586621679242019"><span class="annot"><span class="annottext">gqlFieldToType :: Text -&gt; FieldDefinition -&gt; Q (Type, [(Text, (Text, Type))])
</span><a href="#local-6989586621679242019"><span class="hs-identifier hs-var hs-var">gqlFieldToType</span></a></span></span><span> </span><span id="local-6989586621679242018"><span class="annot"><span class="annottext">sn :: Text
</span><a href="#local-6989586621679242018"><span class="hs-identifier hs-var">sn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.FieldDefinition</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679242016"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679242016"><span class="hs-identifier hs-var">fnm</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679242015"><span class="annot"><span class="annottext">args :: ArgumentsDefinition
</span><a href="#local-6989586621679242015"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621679242014"><span class="annot"><span class="annottext">ftyp :: GType
</span><a href="#local-6989586621679242014"><span class="hs-identifier hs-var">ftyp</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-134"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679242013"><span class="annot"><span class="annottext">argInfos :: [Type]
</span><a href="#local-6989586621679242013"><span class="hs-identifier hs-var">argInfos</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679242012"><span class="annot"><span class="annottext">defaults :: [Maybe (Text, Type)]
</span><a href="#local-6989586621679242012"><span class="hs-identifier hs-var">defaults</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Type, Maybe (Text, Type))] -&gt; ([Type], [Maybe (Text, Type)])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="annot"><span class="annottext">([(Type, Maybe (Text, Type))] -&gt; ([Type], [Maybe (Text, Type)]))
-&gt; Q [(Type, Maybe (Text, Type))]
-&gt; Q ([Type], [Maybe (Text, Type)])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(InputValueDefinition -&gt; Q (Type, Maybe (Text, Type)))
-&gt; ArgumentsDefinition -&gt; Q [(Type, Maybe (Text, Type))]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">InputValueDefinition -&gt; Q (Type, Maybe (Text, Type))
</span><a href="#local-6989586621679242011"><span class="hs-identifier hs-var">argToType</span></a></span><span> </span><span class="annot"><span class="annottext">ArgumentsDefinition
</span><a href="#local-6989586621679242015"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-135"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; [(Text, (Text, Type))] -&gt; (Type, [(Text, (Text, Type))]))
-&gt; TypeQ
-&gt; Q ([(Text, (Text, Type))] -&gt; (Type, [(Text, (Text, Type))]))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Method</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">textToStrLit</span><span> </span><span class="hs-identifier">fnm</span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>                          </span><span class="hs-special">$(</span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">typesToList</span><span> </span><span class="hs-identifier">argInfos</span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>                          </span><span class="hs-special">$(</span><span class="hs-identifier">returnType</span><span> </span><span class="hs-identifier">sn</span><span> </span><span class="hs-identifier">ftyp</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-138"></span><span>          </span><span class="annot"><span class="annottext">Q ([(Text, (Text, Type))] -&gt; (Type, [(Text, (Text, Type))]))
-&gt; Q [(Text, (Text, Type))] -&gt; Q (Type, [(Text, (Text, Type))])
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Text, (Text, Type))] -&gt; Q [(Text, (Text, Type))]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679242016"><span class="hs-identifier hs-var">fnm</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Text, Type) -&gt; (Text, (Text, Type)))
-&gt; [(Text, Type)] -&gt; [(Text, (Text, Type))]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Maybe (Text, Type)] -&gt; [(Text, Type)]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">[Maybe (Text, Type)]
</span><a href="#local-6989586621679242012"><span class="hs-identifier hs-var">defaults</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>    </span><span class="annot"><a href="#local-6989586621679242010"><span class="hs-identifier hs-type">returnType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GQL.GType</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-140"></span><span>    </span><span id="local-6989586621679242010"><span class="annot"><span class="annottext">returnType :: Text -&gt; GType -&gt; TypeQ
</span><a href="#local-6989586621679242010"><span class="hs-identifier hs-var hs-var">returnType</span></a></span></span><span> </span><span id="local-6989586621679242009"><span class="annot"><span class="annottext">serviceName :: Text
</span><a href="#local-6989586621679242009"><span class="hs-identifier hs-var">serviceName</span></a></span></span><span> </span><span id="local-6989586621679242008"><span class="annot"><span class="annottext">typ :: GType
</span><a href="#local-6989586621679242008"><span class="hs-identifier hs-var">typ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-141"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; SchemaMap -&gt; Maybe OperationType
forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><span class="hs-identifier hs-var">HM.lookup</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679242009"><span class="hs-identifier hs-var">serviceName</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaMap
</span><a href="#local-6989586621679242027"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-142"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">GQL.OperationTypeSubscription</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[t|</span><span class="hs-special">'</span><span class="hs-identifier">RetStream</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">retToType</span><span> </span><span class="hs-identifier">typ</span><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><span id="line-143"></span><span>        </span><span class="hs-identifier">_</span><span>                                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[t|</span><span class="hs-special">'</span><span class="hs-identifier">RetSingle</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">retToType</span><span> </span><span class="hs-identifier">typ</span><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><span id="line-144"></span><span>    </span><span class="annot"><a href="#local-6989586621679242011"><span class="hs-identifier hs-type">argToType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GQL.InputValueDefinition</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>    </span><span id="local-6989586621679242011"><span class="annot"><span class="annottext">argToType :: InputValueDefinition -&gt; Q (Type, Maybe (Text, Type))
</span><a href="#local-6989586621679242011"><span class="hs-identifier hs-var hs-var">argToType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.InputValueDefinition</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679242004"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679242004"><span class="hs-identifier hs-var">aname</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679242003"><span class="annot"><span class="annottext">atype :: GType
</span><a href="#local-6989586621679242003"><span class="hs-identifier hs-var">atype</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-146"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Text, Type)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; (Type, Maybe (Text, Type)))
-&gt; TypeQ -&gt; Q (Type, Maybe (Text, Type))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">ArgSingle</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">textToStrLit</span><span> </span><span class="hs-identifier">aname</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">retToType</span><span> </span><span class="hs-identifier">atype</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-147"></span><span>    </span><span class="annot"><a href="#local-6989586621679242011"><span class="hs-identifier hs-var">argToType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.InputValueDefinition</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679242002"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679242002"><span class="hs-identifier hs-var">aname</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679242001"><span class="annot"><span class="annottext">atype :: GType
</span><a href="#local-6989586621679242001"><span class="hs-identifier hs-var">atype</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679242000"><span class="annot"><span class="annottext">defs :: DefaultValue
</span><a href="#local-6989586621679242000"><span class="hs-identifier hs-var">defs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-148"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Maybe (Text, Type) -&gt; (Type, Maybe (Text, Type)))
-&gt; TypeQ -&gt; Q (Maybe (Text, Type) -&gt; (Type, Maybe (Text, Type)))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">ArgSingle</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">textToStrLit</span><span> </span><span class="hs-identifier">aname</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">retToType</span><span> </span><span class="hs-identifier">atype</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-149"></span><span>          </span><span class="annot"><span class="annottext">Q (Maybe (Text, Type) -&gt; (Type, Maybe (Text, Type)))
-&gt; Q (Maybe (Text, Type)) -&gt; Q (Type, Maybe (Text, Type))
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Text, Type) -&gt; Maybe (Text, Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">((Text, Type) -&gt; Maybe (Text, Type))
-&gt; (Type -&gt; (Text, Type)) -&gt; Type -&gt; Maybe (Text, Type)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679242002"><span class="hs-identifier hs-var">aname</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Maybe (Text, Type)) -&gt; TypeQ -&gt; Q (Maybe (Text, Type))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">DefaultValue</span><span> </span><span class="hs-special">$(</span><span> </span><span class="hs-identifier">defToVConst</span><span> </span><span class="hs-identifier">defs</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>    </span><span class="annot"><a href="#local-6989586621679241999"><span class="hs-identifier hs-type">defToVConst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GQL.DefaultValue</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-151"></span><span>    </span><span id="local-6989586621679241999"><span class="annot"><span class="annottext">defToVConst :: DefaultValue -&gt; TypeQ
</span><a href="#local-6989586621679241999"><span class="hs-identifier hs-var hs-var">defToVConst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.VCBoolean</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">VCBoolean</span><span class="hs-special">|]</span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><a href="#local-6989586621679241999"><span class="hs-identifier hs-var">defToVConst</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">GQL.VCNull</span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">VCNull</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><a href="#local-6989586621679241999"><span class="hs-identifier hs-var">defToVConst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.VCInt</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">VCInt</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-154"></span><span>    </span><span class="annot"><a href="#local-6989586621679241999"><span class="hs-identifier hs-var">defToVConst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.VCFloat</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; TypeQ
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="hs-string">&quot;floats as default arguments are not supported&quot;</span></span><span>
</span><span id="line-156"></span><span>    </span><span class="annot"><a href="#local-6989586621679241999"><span class="hs-identifier hs-var">defToVConst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.VCString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StringValue -&gt; Text
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679241993"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679241993"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">VCString</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">textToStrLit</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-158"></span><span>    </span><span class="annot"><a href="#local-6989586621679241999"><span class="hs-identifier hs-var">defToVConst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.VCEnum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EnumValue -&gt; Text
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679241991"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679241991"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">VCEnum</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">textToStrLit</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-160"></span><span>    </span><span class="annot"><a href="#local-6989586621679241999"><span class="hs-identifier hs-var">defToVConst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.VCList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.ListValueG</span></span><span> </span><span id="local-6989586621679241988"><span class="annot"><span class="annottext">xs :: [DefaultValue]
</span><a href="#local-6989586621679241988"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">VCList</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">typesToList</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-identifier">defToVConst</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-162"></span><span>    </span><span class="annot"><a href="#local-6989586621679241999"><span class="hs-identifier hs-var">defToVConst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.VCObject</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.ObjectValueG</span></span><span> </span><span id="local-6989586621679241985"><span class="annot"><span class="annottext">obj :: [ObjectFieldG DefaultValue]
</span><a href="#local-6989586621679241985"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">VCObject</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">typesToList</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-identifier">fromGQLField</span><span> </span><span class="hs-identifier">obj</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-164"></span><span>    </span><span class="annot"><a href="#local-6989586621679241984"><span class="hs-identifier hs-type">fromGQLField</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GQL.ObjectFieldG</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">GQL.ValueConst</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-165"></span><span>    </span><span id="local-6989586621679241984"><span class="annot"><span class="annottext">fromGQLField :: ObjectFieldG DefaultValue -&gt; TypeQ
</span><a href="#local-6989586621679241984"><span class="hs-identifier hs-var hs-var">fromGQLField</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.ObjectFieldG</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679241981"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679241981"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679241980"><span class="annot"><span class="annottext">v :: DefaultValue
</span><a href="#local-6989586621679241980"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-special">(</span><span class="hs-special">$(</span><span class="hs-identifier">textToStrLit</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">defToVConst</span><span> </span><span class="hs-identifier">v</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-166"></span><span>    </span><span class="annot"><a href="#local-6989586621679241979"><span class="hs-identifier hs-type">retToType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GQL.GType</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-167"></span><span>    </span><span id="local-6989586621679241979"><span class="annot"><span class="annottext">retToType :: GType -&gt; TypeQ
</span><a href="#local-6989586621679241979"><span class="hs-identifier hs-var hs-var">retToType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.TypeNamed</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nullability -&gt; Bool
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamedType -&gt; Name
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679241977"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679241977"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-168"></span><span>      </span><span class="hs-special">[t|</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">gqlTypeToType</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">tm</span><span> </span><span class="hs-identifier">schemaName</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-169"></span><span>    </span><span class="annot"><a href="#local-6989586621679241979"><span class="hs-identifier hs-var">retToType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.TypeNamed</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nullability -&gt; Bool
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamedType -&gt; Name
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679241976"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679241976"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-170"></span><span>      </span><span class="hs-special">[t|</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">OptionalRef</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">gqlTypeToType</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">tm</span><span> </span><span class="hs-identifier">schemaName</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-171"></span><span>    </span><span class="annot"><a href="#local-6989586621679241979"><span class="hs-identifier hs-var">retToType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.TypeList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nullability -&gt; Bool
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ListType -&gt; GType
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679241974"><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621679241974"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-172"></span><span>      </span><span class="hs-special">[t|</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">ListRef</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">retToType</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-173"></span><span>    </span><span class="annot"><a href="#local-6989586621679241979"><span class="hs-identifier hs-var">retToType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.TypeList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nullability -&gt; Bool
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ListType -&gt; GType
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679241973"><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621679241973"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-174"></span><span>      </span><span class="hs-special">[t|</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">OptionalRef</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier">ListRef</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">retToType</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-175"></span><span>    </span><span class="annot"><a href="#local-6989586621679241979"><span class="hs-identifier hs-var">retToType</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; TypeQ
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="hs-string">&quot;this should not happen, please, file an issue&quot;</span></span><span>
</span><span id="line-176"></span><span class="annot"><a href="Mu.GraphQL.Quasi.html#typeToDec"><span class="hs-identifier hs-var">typeToDec</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.TypeDefinitionEnum</span></span><span> </span><span id="local-6989586621679241972"><span class="annot"><span class="annottext">enums :: EnumTypeDefinition
</span><a href="#local-6989586621679241972"><span class="hs-identifier hs-var">enums</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EnumTypeDefinition -&gt; Q Result
</span><a href="#local-6989586621679241971"><span class="hs-identifier hs-var">enumToDecl</span></a></span><span> </span><span class="annot"><span class="annottext">EnumTypeDefinition
</span><a href="#local-6989586621679241972"><span class="hs-identifier hs-var">enums</span></a></span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-178"></span><span>    </span><span class="annot"><a href="#local-6989586621679241971"><span class="hs-identifier hs-type">enumToDecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GQL.EnumTypeDefinition</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><a href="Mu.GraphQL.Quasi.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621679241971"><span class="annot"><span class="annottext">enumToDecl :: EnumTypeDefinition -&gt; Q Result
</span><a href="#local-6989586621679241971"><span class="hs-identifier hs-var hs-var">enumToDecl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.EnumTypeDefinition</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679241970"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679241970"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679241969"><span class="annot"><span class="annottext">symbols :: [EnumValueDefinition]
</span><a href="#local-6989586621679241969"><span class="hs-identifier hs-var">symbols</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-180"></span><span>      </span><span class="annot"><span class="annottext">Type -&gt; Result
</span><a href="Mu.GraphQL.Quasi.html#GQLSchema"><span class="hs-identifier hs-var">GQLSchema</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Result) -&gt; TypeQ -&gt; Q Result
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">[t|</span><span class="hs-special">'</span><span class="hs-identifier">DEnum</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">textToStrLit</span><span> </span><span class="hs-identifier">name</span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>                              </span><span class="hs-special">$(</span><span class="hs-identifier">typesToList</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-identifier">gqlChoiceToType</span><span> </span><span class="hs-identifier">symbols</span><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><span id="line-182"></span><span>    </span><span class="annot"><a href="#local-6989586621679241968"><span class="hs-identifier hs-type">gqlChoiceToType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GQL.EnumValueDefinition</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-183"></span><span>    </span><span id="local-6989586621679241968"><span class="annot"><span class="annottext">gqlChoiceToType :: EnumValueDefinition -&gt; TypeQ
</span><a href="#local-6989586621679241968"><span class="hs-identifier hs-var hs-var">gqlChoiceToType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.EnumValueDefinition</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EnumValue -&gt; Text
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679241966"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679241966"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-184"></span><span>      </span><span class="hs-special">[t|</span><span class="hs-special">'</span><span class="hs-identifier">ChoiceDef</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">textToStrLit</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><span id="line-185"></span><span class="annot"><a href="Mu.GraphQL.Quasi.html#typeToDec"><span class="hs-identifier hs-var">typeToDec</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.TypeDefinitionInputObject</span></span><span> </span><span id="local-6989586621679241965"><span class="annot"><span class="annottext">inpts :: InputObjectTypeDefinition
</span><a href="#local-6989586621679241965"><span class="hs-identifier hs-var">inpts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InputObjectTypeDefinition -&gt; Q Result
</span><a href="#local-6989586621679241964"><span class="hs-identifier hs-var">inputObjToDec</span></a></span><span> </span><span class="annot"><span class="annottext">InputObjectTypeDefinition
</span><a href="#local-6989586621679241965"><span class="hs-identifier hs-var">inpts</span></a></span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-187"></span><span>    </span><span class="annot"><a href="#local-6989586621679241964"><span class="hs-identifier hs-type">inputObjToDec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GQL.InputObjectTypeDefinition</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><a href="Mu.GraphQL.Quasi.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span>
</span><span id="line-188"></span><span>    </span><span id="local-6989586621679241964"><span class="annot"><span class="annottext">inputObjToDec :: InputObjectTypeDefinition -&gt; Q Result
</span><a href="#local-6989586621679241964"><span class="hs-identifier hs-var hs-var">inputObjToDec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.InputObjectTypeDefinition</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679241963"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679241963"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679241962"><span class="annot"><span class="annottext">fields :: ArgumentsDefinition
</span><a href="#local-6989586621679241962"><span class="hs-identifier hs-var">fields</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-189"></span><span>        </span><span class="annot"><span class="annottext">Type -&gt; Result
</span><a href="Mu.GraphQL.Quasi.html#GQLSchema"><span class="hs-identifier hs-var">GQLSchema</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Result) -&gt; TypeQ -&gt; Q Result
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">[t|</span><span class="hs-special">'</span><span class="hs-identifier">DRecord</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">textToStrLit</span><span> </span><span class="hs-identifier">name</span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>                                  </span><span class="hs-special">$(</span><span class="hs-identifier">typesToList</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-identifier">gqlFieldToType</span><span> </span><span class="hs-identifier">fields</span><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><a href="#local-6989586621679241961"><span class="hs-identifier hs-type">gqlFieldToType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GQL.InputValueDefinition</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-192"></span><span>    </span><span id="local-6989586621679241961"><span class="annot"><span class="annottext">gqlFieldToType :: InputValueDefinition -&gt; TypeQ
</span><a href="#local-6989586621679241961"><span class="hs-identifier hs-var hs-var">gqlFieldToType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.InputValueDefinition</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679241960"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679241960"><span class="hs-identifier hs-var">fname</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679241959"><span class="annot"><span class="annottext">ftype :: GType
</span><a href="#local-6989586621679241959"><span class="hs-identifier hs-var">ftype</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-193"></span><span>      </span><span class="hs-special">[t|</span><span class="hs-special">'</span><span class="hs-identifier">FieldDef</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">textToStrLit</span><span> </span><span class="hs-identifier">fname</span><span class="hs-special">)</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">ginputTypeToType</span><span> </span><span class="hs-identifier">ftype</span><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><a href="#local-6989586621679241958"><span class="hs-identifier hs-type">ginputTypeToType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GQL.GType</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-195"></span><span>    </span><span id="local-6989586621679241958"><span class="annot"><span class="annottext">ginputTypeToType :: GType -&gt; TypeQ
</span><a href="#local-6989586621679241958"><span class="hs-identifier hs-var hs-var">ginputTypeToType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.TypeNamed</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nullability -&gt; Bool
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamedType -&gt; Name
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679241957"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679241957"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-196"></span><span>      </span><span class="hs-special">[t|</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">typeToPrimType</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-197"></span><span>    </span><span class="annot"><a href="#local-6989586621679241958"><span class="hs-identifier hs-var">ginputTypeToType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.TypeNamed</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nullability -&gt; Bool
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamedType -&gt; Name
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679241956"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679241956"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-198"></span><span>      </span><span class="hs-special">[t|</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">OptionalRef</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">typeToPrimType</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-199"></span><span>    </span><span class="annot"><a href="#local-6989586621679241958"><span class="hs-identifier hs-var">ginputTypeToType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.TypeList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nullability -&gt; Bool
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ListType -&gt; GType
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679241955"><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621679241955"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-200"></span><span>      </span><span class="hs-special">[t|</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">ListRef</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">ginputTypeToType</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-201"></span><span>    </span><span class="annot"><a href="#local-6989586621679241958"><span class="hs-identifier hs-var">ginputTypeToType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GQL.TypeList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nullability -&gt; Bool
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ListType -&gt; GType
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679241954"><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621679241954"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-202"></span><span>      </span><span class="hs-special">[t|</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">OptionalRef</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier">ListRef</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">ginputTypeToType</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><a href="#local-6989586621679241958"><span class="hs-identifier hs-var">ginputTypeToType</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; TypeQ
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="hs-string">&quot;this should not happen, please, file an issue&quot;</span></span><span>
</span><span id="line-204"></span><span>    </span><span class="annot"><a href="#local-6989586621679241953"><span class="hs-identifier hs-type">typeToPrimType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GQL.Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-205"></span><span>    </span><span id="local-6989586621679241953"><span class="annot"><span class="annottext">typeToPrimType :: Name -&gt; TypeQ
</span><a href="#local-6989586621679241953"><span class="hs-identifier hs-var hs-var">typeToPrimType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">GQL.unName</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Int&quot;</span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span class="hs-special">'</span><span class="hs-identifier">TPrimitive</span><span> </span><span class="hs-identifier">Integer</span><span class="hs-special">|]</span><span>
</span><span id="line-206"></span><span>    </span><span class="annot"><a href="#local-6989586621679241953"><span class="hs-identifier hs-var">typeToPrimType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">GQL.unName</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Float&quot;</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span class="hs-special">'</span><span class="hs-identifier">TPrimitive</span><span> </span><span class="hs-identifier">Double</span><span class="hs-special">|]</span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><a href="#local-6989586621679241953"><span class="hs-identifier hs-var">typeToPrimType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">GQL.unName</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;String&quot;</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span class="hs-special">'</span><span class="hs-identifier">TPrimitive</span><span> </span><span class="hs-identifier">T.Text</span><span class="hs-special">|]</span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><a href="#local-6989586621679241953"><span class="hs-identifier hs-var">typeToPrimType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">GQL.unName</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Boolean&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span class="hs-special">'</span><span class="hs-identifier">TPrimitive</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">|]</span><span>
</span><span id="line-209"></span><span>    </span><span class="annot"><a href="#local-6989586621679241953"><span class="hs-identifier hs-var">typeToPrimType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">GQL.unName</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;ID&quot;</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span class="hs-special">'</span><span class="hs-identifier">TPrimitive</span><span> </span><span class="hs-identifier">UUID</span><span class="hs-special">|]</span><span>
</span><span id="line-210"></span><span>    </span><span class="annot"><a href="#local-6989586621679241953"><span class="hs-identifier hs-var">typeToPrimType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679241951"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679241951"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span class="hs-special">'</span><span class="hs-identifier">TSchematic</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">textToStrLit</span><span> </span><span class="hs-identifier">name</span><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="annot"><a href="Mu.GraphQL.Quasi.html#gqlTypeToType"><span class="hs-identifier hs-type">gqlTypeToType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GQL.Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Mu.GraphQL.Quasi.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-213"></span><span id="gqlTypeToType"><span class="annot"><span class="annottext">gqlTypeToType :: Name -&gt; TypeMap -&gt; Name -&gt; TypeQ
</span><a href="Mu.GraphQL.Quasi.html#gqlTypeToType"><span class="hs-identifier hs-var hs-var">gqlTypeToType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">GQL.unName</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Int&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span class="hs-special">'</span><span class="hs-identifier">PrimitiveRef</span><span> </span><span class="hs-identifier">Integer</span><span class="hs-special">|]</span><span>
</span><span id="line-214"></span><span class="annot"><a href="Mu.GraphQL.Quasi.html#gqlTypeToType"><span class="hs-identifier hs-var">gqlTypeToType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">GQL.unName</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Float&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span class="hs-special">'</span><span class="hs-identifier">PrimitiveRef</span><span> </span><span class="hs-identifier">Double</span><span class="hs-special">|]</span><span>
</span><span id="line-215"></span><span class="annot"><a href="Mu.GraphQL.Quasi.html#gqlTypeToType"><span class="hs-identifier hs-var">gqlTypeToType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">GQL.unName</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;String&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span class="hs-special">'</span><span class="hs-identifier">PrimitiveRef</span><span> </span><span class="hs-identifier">T.Text</span><span class="hs-special">|]</span><span>
</span><span id="line-216"></span><span class="annot"><a href="Mu.GraphQL.Quasi.html#gqlTypeToType"><span class="hs-identifier hs-var">gqlTypeToType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">GQL.unName</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Boolean&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span class="hs-special">'</span><span class="hs-identifier">PrimitiveRef</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">|]</span><span>
</span><span id="line-217"></span><span class="annot"><a href="Mu.GraphQL.Quasi.html#gqlTypeToType"><span class="hs-identifier hs-var">gqlTypeToType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">GQL.unName</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;ID&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span class="hs-special">'</span><span class="hs-identifier">PrimitiveRef</span><span> </span><span class="hs-identifier">UUID</span><span class="hs-special">|]</span><span>
</span><span id="line-218"></span><span class="annot"><a href="Mu.GraphQL.Quasi.html#gqlTypeToType"><span class="hs-identifier hs-var">gqlTypeToType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679241950"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679241950"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679241949"><span class="annot"><span class="annottext">tm :: TypeMap
</span><a href="#local-6989586621679241949"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span id="local-6989586621679241948"><span class="annot"><span class="annottext">schemaName :: Name
</span><a href="#local-6989586621679241948"><span class="hs-identifier hs-var">schemaName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679241947"><span class="annot"><span class="annottext">schemaRef :: TypeQ
</span><a href="#local-6989586621679241947"><span class="hs-identifier hs-var hs-var">schemaRef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span class="hs-special">'</span><span class="hs-identifier">SchemaRef</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">conT</span><span> </span><span class="hs-identifier">schemaName</span><span class="hs-special">)</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">textToStrLit</span><span> </span><span class="hs-identifier">name</span><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><span id="line-220"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; TypeMap -&gt; Maybe GQLType
forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><span class="hs-identifier hs-var">HM.lookup</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679241950"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">TypeMap
</span><a href="#local-6989586621679241949"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-221"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="Mu.GraphQL.Quasi.html#Enum"><span class="hs-identifier hs-type">Enum</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeQ
</span><a href="#local-6989586621679241947"><span class="hs-identifier hs-var">schemaRef</span></a></span><span>
</span><span id="line-222"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="Mu.GraphQL.Quasi.html#InputObject"><span class="hs-identifier hs-type">InputObject</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeQ
</span><a href="#local-6989586621679241947"><span class="hs-identifier hs-var">schemaRef</span></a></span><span>
</span><span id="line-223"></span><span>        </span><span class="hs-identifier">_</span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[t|</span><span class="hs-special">'</span><span class="hs-identifier">ObjectRef</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">textToStrLit</span><span> </span><span class="hs-identifier">name</span><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="annot"><a href="Mu.GraphQL.Quasi.html#typesToList"><span class="hs-identifier hs-type">typesToList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-226"></span><span id="typesToList"><span class="annot"><span class="annottext">typesToList :: [Type] -&gt; Type
</span><a href="Mu.GraphQL.Quasi.html#typesToList"><span class="hs-identifier hs-var hs-var">typesToList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; Type) -&gt; Type -&gt; [Type] -&gt; Type
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">AppT</span></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; Type) -&gt; (Type -&gt; Type) -&gt; Type -&gt; Type -&gt; Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">AppT</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">PromotedConsT</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">PromotedNilT</span></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="annot"><a href="Mu.GraphQL.Quasi.html#textToStrLit"><span class="hs-identifier hs-type">textToStrLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-229"></span><span id="textToStrLit"><span class="annot"><span class="annottext">textToStrLit :: Text -&gt; TypeQ
</span><a href="Mu.GraphQL.Quasi.html#textToStrLit"><span class="hs-identifier hs-var hs-var">textToStrLit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyLitQ -&gt; TypeQ
</span><span class="hs-identifier hs-var">litT</span></span><span> </span><span class="annot"><span class="annottext">(TyLitQ -&gt; TypeQ) -&gt; (Text -&gt; TyLitQ) -&gt; Text -&gt; TypeQ
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; TyLitQ
</span><span class="hs-identifier hs-var">strTyLit</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TyLitQ) -&gt; (Text -&gt; String) -&gt; Text -&gt; TyLitQ
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span>
</span><span id="line-230"></span></pre></body></html>